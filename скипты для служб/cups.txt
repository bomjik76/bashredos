#!/bin/bash

#CUPS
echo "Устанавливаем и настраиваем CUPS..."
# Установка CUPS
yum install -y cups
# Включение и запуск службы CUPS
systemctl enable cups
systemctl start cups
# Открытие доступа через локальную сеть
cupsd_conf="/etc/cups/cupsd.conf"
sed -i 's/<Location \/>/<Location \/>\n  Allow all\n/g' $cupsd_conf
sed -i "s/Listen localhost:631/Listen 0.0.0.0:631/" $cupsd_conf
sed -i 's/<Location \/admin>/<Location \/admin>\n  Allow all\n/g' $cupsd_conf
# Перезапуск службы
systemctl restart cups
# Создание виртуального PDF-принтера
lpadmin -p Virtual_PDF_Printer -E -v cups-pdf:/ -m drv:///sample.drv/generic.ppd
lpadmin -d Virtual_PDF_Printer
lpadmin -p Virtual_PDF_Printer -u allow:all
echo "CUPS настроен. Виртуальный PDF-принтер опубликован."

echo "Настройка завершена."